<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Click Counter Challenge</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <style id="app-style">
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap');
    
    body {
      font-family: 'Poppins', sans-serif;
      background-color: #f9fafb;
      min-height: 100vh;
    }
    
    .click-button {
      transition: transform 0.1s ease, background-color 0.2s ease;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
    }
    
    .click-button:active {
      transform: scale(0.98);
    }
    
    .click-button.flash {
      background-color: #fbbf24 !important;
    }
    
    .file-input-label {
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .file-input-label:hover {
      background-color: #2563eb;
    }
    
    .progress-bar {
      height: 10px;
      transition: width 0.2s ease;
    }
    
    .confetti-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 100;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    @keyframes fadeOut {
      from { opacity: 1; }
      to { opacity: 0; }
    }

    .fade-in {
      animation: fadeIn 0.5s ease forwards;
    }

    .fade-out {
      animation: fadeOut 0.5s ease forwards;
    }

    .badge-pulse {
      animation: pulse 1s infinite;
    }

    @keyframes pulse {
      0% {
        transform: scale(1);
      }
      50% {
        transform: scale(1.05);
      }
      100% {
        transform: scale(1);
      }
    }
  </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-50">
  <div class="container max-w-md mx-auto px-4 py-12">
    <div class="bg-white rounded-2xl shadow-xl p-6 mb-8">
      <h1 class="text-3xl font-bold text-center text-gray-800 mb-2">Quick Click Challenge</h1>
      <p class="text-center text-gray-600 mb-8">Click 10 times in 2 seconds to hear applause!</p>

      <div class="flex justify-between items-center mb-4">
        <div class="text-lg font-semibold text-gray-700">
          <span id="click-counter" class="text-blue-600">0</span><span class="text-blue-600">/10</span> Clicks
        </div>
        <div class="text-lg font-semibold text-gray-700">
          Time: <span id="timer" class="text-blue-600">2.0</span>s
        </div>
      </div>

      <div class="w-full bg-gray-200 rounded-full mb-6">
        <div id="progress-bar" class="progress-bar bg-blue-600 rounded-full w-0"></div>
      </div>

      <button id="click-button" class="click-button w-full py-16 px-6 bg-blue-500 hover:bg-blue-600 text-white text-xl font-bold rounded-2xl mb-6 focus:outline-none focus:ring-4 focus:ring-blue-300" aria-label="Click here button">
        Click Here!
      </button>

      <div id="success-message" class="hidden text-center mb-6 fade-in">
        <span class="inline-flex items-center px-4 py-2 rounded-full text-lg font-semibold bg-green-100 text-green-800 badge-pulse">
          <i class="fas fa-check-circle mr-2"></i> Great job! 10 clicks in time!
        </span>
      </div>

      <div id="reset-container" class="hidden text-center mb-6 fade-in">
        <button id="reset-button" class="bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 px-6 rounded-lg focus:outline-none focus:ring-4 focus:ring-gray-300">
          <i class="fas fa-redo mr-2"></i> Reset
        </button>
      </div>
      
      <div class="mb-6 border-t border-gray-200 pt-6">
        <label class="block text-gray-700 font-semibold mb-3" for="custom-sound">
          Custom Applause Sound (optional)
        </label>
        <div class="flex flex-col space-y-2">
          <label class="file-input-label flex items-center justify-center w-full bg-blue-500 text-white py-3 px-4 rounded-lg cursor-pointer">
            <i class="fas fa-upload mr-2"></i>
            <span id="file-label">Upload Audio File</span>
            <input type="file" id="custom-sound" class="hidden" accept=".mp3,.wav,.ogg">
          </label>
          <p class="text-xs text-gray-500 text-center">Supports MP3, WAV, OGG (max 25MB)</p>
        </div>
      </div>
      
      <div id="current-sound" class="text-sm text-center text-gray-600">
        Using default applause sound
      </div>
    </div>
    
    <footer class="text-center text-gray-500 text-sm">
      <p>Click Counter Challenge Â© 2025</p>
    </footer>
  </div>
  
  <!-- Audio elements -->
  <audio id="applause-sound" preload="auto">
    <source src="https://assets.mixkit.co/active_storage/sfx/2099/2099-preview.mp3" type="audio/mp3">
    Your browser does not support the audio element.
  </audio>
  
  <script id="app-script">
    document.addEventListener('DOMContentLoaded', () => {
      // DOM Elements
      const clickButton = document.getElementById('click-button');
      const clickCounter = document.getElementById('click-counter');
      const timerElement = document.getElementById('timer');
      const progressBar = document.getElementById('progress-bar');
      const resetButton = document.getElementById('reset-button');
      const resetContainer = document.getElementById('reset-container');
      const successMessage = document.getElementById('success-message');
      const customSoundInput = document.getElementById('custom-sound');
      const fileLabel = document.getElementById('file-label');
      const currentSound = document.getElementById('current-sound');
      const applauseSound = document.getElementById('applause-sound');
      
      // State variables
      let clicks = 0;
      let isTimerRunning = false;
      let timerValue = 2;
      let timerInterval = null;
      let hasWon = false;
      let customAudioUrl = null;
      
      // Load saved audio from localStorage if available
      const loadSavedAudio = () => {
        const savedAudio = localStorage.getItem('customApplauseAudio');
        if (savedAudio) {
          try {
            const audioData = JSON.parse(savedAudio);
            if (audioData && audioData.name && audioData.timestamp) {
              currentSound.textContent = `Using custom sound: ${audioData.name}`;
              // Note: In a real implementation, we'd need to handle the actual audio data
              // For the prototype, we just update the UI
            }
          } catch (e) {
            console.error('Error loading saved audio:', e);
          }
        }
      };
      
      loadSavedAudio();

      // Reset the game state
      const resetGame = () => {
        clicks = 0;
        timerValue = 2;
        hasWon = false;
        isTimerRunning = false;
        
        clickCounter.textContent = clicks;
        timerElement.textContent = '2.0';
        progressBar.style.width = '0%';
        
        if (timerInterval) {
          clearInterval(timerInterval);
          timerInterval = null;
        }
        
        successMessage.classList.add('hidden');
        resetContainer.classList.add('hidden');
      };
      
      // Update the progress bar based on clicks
      const updateProgressBar = () => {
        const percentage = (clicks / 10) * 100;
        progressBar.style.width = `${percentage}%`;
      };
      
      // Flash animation for the click button
      const flashButton = () => {
        clickButton.classList.add('flash');
        setTimeout(() => {
          clickButton.classList.remove('flash');
        }, 100);
      };
      
      // Trigger confetti animation
      const triggerConfetti = () => {
        confetti({
          particleCount: 100,
          spread: 70,
          origin: { y: 0.6 }
        });
      };
      
      // Handle win condition
      const handleWin = () => {
        hasWon = true;
        
        // Play sound
        applauseSound.play();
        
        // Show success message and reset button
        successMessage.classList.remove('hidden');
        resetContainer.classList.remove('hidden');
        
        // Trigger confetti
        triggerConfetti();
        
        // Clear timer
        clearInterval(timerInterval);
        timerInterval = null;
      };
      
      // Start or continue the timer
      const startTimer = () => {
        if (!isTimerRunning) {
          isTimerRunning = true;
          timerValue = 2.0;
          
          timerInterval = setInterval(() => {
            timerValue -= 0.1;
            timerValue = Math.max(0, parseFloat(timerValue.toFixed(1)));
            timerElement.textContent = timerValue.toFixed(1);
            
            if (timerValue <= 0) {
              clearInterval(timerInterval);
              isTimerRunning = false;
              
              // If didn't reach 10 clicks, reset the clicks
              if (clicks < 10 && !hasWon) {
                setTimeout(() => {
                  clicks = 0;
                  clickCounter.textContent = clicks;
                  updateProgressBar();
                }, 500);
              }
            }
          }, 100);
        }
      };
      
      // Click button event handler
      clickButton.addEventListener('click', () => {
        if (hasWon) return;
        
        flashButton();
        startTimer();
        
        clicks++;
        clickCounter.textContent = clicks;
        updateProgressBar();
        
        if (clicks >= 10) {
          handleWin();
        }
      });
      
      // Reset button event handler
      resetButton.addEventListener('click', resetGame);
      
      // Custom sound file handler
      customSoundInput.addEventListener('change', (e) => {
        const file = e.target.files[0];
        
        if (file) {
          if (file.size > 25 * 1024 * 1024) {
            alert('File is too large! Maximum size is 25MB.');
            customSoundInput.value = '';
            return;
          }
          
          const validTypes = ['audio/mp3', 'audio/wav', 'audio/ogg', 'audio/mpeg'];
          
          if (!validTypes.includes(file.type) && 
              !file.name.endsWith('.mp3') && 
              !file.name.endsWith('.wav') && 
              !file.name.endsWith('.ogg')) {
            alert('Please upload an MP3, WAV, or OGG file.');
            customSoundInput.value = '';
            return;
          }
          
          fileLabel.textContent = file.name;
          currentSound.textContent = `Using custom sound: ${file.name}`;
          
          // In a real implementation, we'd create an object URL and set it as the source
          // For the prototype, we'll just store the file name and timestamp
          const audioData = {
            name: file.name,
            timestamp: new Date().getTime()
          };
          
          // Store in localStorage
          localStorage.setItem('customApplauseAudio', JSON.stringify(audioData));
          
          // For the prototype, we keep using the default sound
          // In a real implementation, we'd create a URL for the uploaded file
        }
      });
    });
  </script>
</body>
</html>